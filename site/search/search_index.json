{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"methylphase documentation \u00b6 Welcome to the methylphase docs. This site is organized for GitHub Pages/MkDocs style publishing, with standalone Markdown files that can also be ingested by Sphinx (via MyST) if you prefer that toolchain. Documentation map \u00b6 Overview Installation Quickstart Usage guides: Phase variants pipeline Extract methylation calls Split reads Typing utilities Utility commands Example analysis FAQ and troubleshooting Build a docs site (MkDocs) \u00b6 1) Install MkDocs (and an optional theme): pip install mkdocs mkdocs-material 2) Serve locally: mkdocs serve (opens http://127.0.0.1:8000). 3) Publish to GitHub Pages: mkdocs gh-deploy (requires the gh-pages branch to exist or be creatable by your CI). The included mkdocs.yml already wires this structure; adjust navigation there if you add pages. Using Sphinx instead \u00b6 If you prefer Sphinx, enable Markdown with MyST ( pip install sphinx myst-parser ), run sphinx-quickstart , and point source to docs/ . Add these lines to conf.py : extensions = [\"myst_parser\"] source_suffix = {\".rst\": \"restructuredtext\", \".md\": \"markdown\"} Then build with sphinx-build -b html docs build/html or serve via sphinx-autobuild .","title":"Home"},{"location":"#methylphase-documentation","text":"Welcome to the methylphase docs. This site is organized for GitHub Pages/MkDocs style publishing, with standalone Markdown files that can also be ingested by Sphinx (via MyST) if you prefer that toolchain.","title":"methylphase documentation"},{"location":"#documentation-map","text":"Overview Installation Quickstart Usage guides: Phase variants pipeline Extract methylation calls Split reads Typing utilities Utility commands Example analysis FAQ and troubleshooting","title":"Documentation map"},{"location":"#build-a-docs-site-mkdocs","text":"1) Install MkDocs (and an optional theme): pip install mkdocs mkdocs-material 2) Serve locally: mkdocs serve (opens http://127.0.0.1:8000). 3) Publish to GitHub Pages: mkdocs gh-deploy (requires the gh-pages branch to exist or be creatable by your CI). The included mkdocs.yml already wires this structure; adjust navigation there if you add pages.","title":"Build a docs site (MkDocs)"},{"location":"#using-sphinx-instead","text":"If you prefer Sphinx, enable Markdown with MyST ( pip install sphinx myst-parser ), run sphinx-quickstart , and point source to docs/ . Add these lines to conf.py : extensions = [\"myst_parser\"] source_suffix = {\".rst\": \"restructuredtext\", \".md\": \"markdown\"} Then build with sphinx-build -b html docs build/html or serve via sphinx-autobuild .","title":"Using Sphinx instead"},{"location":"faq/","text":"FAQ and troubleshooting \u00b6 The tool says MM/ML tags are missing. Ensure your aligner wrote modification tags; some pipelines require --mod-tags or equivalent. Without MM/ML tags, methylphase cannot locate methylation coordinates. The BAM is missing an index. Create one with samtools index sample.mod.bam (or provide a CRAM with a .crai ). SEQ is absent in the BAM header. Provide --sequence-fallback <fastq|bam> (and index the fallback if large) so methylphase can recover base sequences for motif placement. Clusters look noisy or over-split. Try --cluster-algorithm hdbscan in split-reads , or tighten class bounds/penalty in phase-variants (e.g., --max-classes 6 , --penalty-multiplier 3.0 ). Outputs are huge. Disable FASTQ/BAM emission during split-reads unless needed ( --emit-fastq=false ), and limit motifs to those required for the analysis. Model selection feels off. Inspect fits/ and summary.json for criterion values; switch from icl to bic or cv ( --criterion ) and adjust --penalty-multiplier when models under/over fit. Performance is slow. Increase --threads for extraction/clustering; keep BAM on fast storage and avoid overly large motif sets when possible.","title":"FAQ and troubleshooting"},{"location":"faq/#faq-and-troubleshooting","text":"The tool says MM/ML tags are missing. Ensure your aligner wrote modification tags; some pipelines require --mod-tags or equivalent. Without MM/ML tags, methylphase cannot locate methylation coordinates. The BAM is missing an index. Create one with samtools index sample.mod.bam (or provide a CRAM with a .crai ). SEQ is absent in the BAM header. Provide --sequence-fallback <fastq|bam> (and index the fallback if large) so methylphase can recover base sequences for motif placement. Clusters look noisy or over-split. Try --cluster-algorithm hdbscan in split-reads , or tighten class bounds/penalty in phase-variants (e.g., --max-classes 6 , --penalty-multiplier 3.0 ). Outputs are huge. Disable FASTQ/BAM emission during split-reads unless needed ( --emit-fastq=false ), and limit motifs to those required for the analysis. Model selection feels off. Inspect fits/ and summary.json for criterion values; switch from icl to bic or cv ( --criterion ) and adjust --penalty-multiplier when models under/over fit. Performance is slow. Increase --threads for extraction/clustering; keep BAM on fast storage and avoid overly large motif sets when possible.","title":"FAQ and troubleshooting"},{"location":"overview/","text":"Overview \u00b6 methylphase is a toolkit for BAM-driven methylation phasing and typing. It extracts per-read methylation features from mod-tagged alignments (MM/ML tags), clusters reads by motif patterns, and aggregates or imputes results for downstream analyses. What methylphase does \u00b6 Phase variants pipeline : end-to-end typing that merges motif-derived methylation features with a Floria haploset, selects a latent class model, and emits imputed labels and summaries. Split reads : cluster reads by motif methylation profiles (GMM by default; HDBSCAN and agglomerative are available) and write clustering tables plus optional FASTQ/BAM splits. Extract : intersect motifs with alignments to produce per-read and aggregate methylation tables, and optionally motif summaries or FASTQ subsets. Typing utilities : EM fitting, model selection, imputation, Floria conversion, and FASTQ splitting from existing assignments. Utilities : contig/read inspection, VCF summarization, methylation imputation directly into BAM, and longitudinal agreement checks. Inputs and assumptions \u00b6 Aligned BAM with MM/ML tags is required for methylation coordinates; provide a BAM index. If SEQ is missing, supply --sequence-fallback (FASTQ/BAM). Motifs can be inline ( GATC_6mA_1 ) or provided via file (TSV/CSV with motif, mod_type, mod_position, optional complement/bin/reference columns). Floria haploset (for phase-variants ) supplies SNP haplotypes that are merged with methylation features. Motif interpretation is strand-aware; complements in motif files control reverse-strand handling. Outputs (high level) \u00b6 Split reads : read_clustering.tsv , read_clustering_raw.tsv , cluster_summary.tsv , and optional clustered FASTQ/BAMs. Phase variants : internal split_reads/ artifacts, dataset.tsv , categories.toml , fits/ , best_model.json , best_responsibilities.tsv , imputed.tsv , imputed_labels.tsv , and summary.json . Extract : per_read.tsv , aggregate.tsv , optional motif_summary.tsv , and FASTQ subsets when requested. Utilities : VCFs ( *.vcf or bgzip+tabix), imputed BAMs, and longitudinal reports. Modeling notes \u00b6 Latent class model uses EM with Dirichlet priors for weights/emissions; supports continuous methylation features (Gaussian) and categorical haplotypes. Model selection defaults to ICL with penalty multiplier 2.0 and class bounds 1..10; alternative criteria include BIC and cross-validation. Imputation outputs MAP labels for categorical fields and responsibility-weighted means for methylation features; classes with low weight can be pruned. Project layout (code) \u00b6 src/main.rs : CLI entrypoint, delegates to commands::run . src/cli.rs : top-level CLI definitions for commands/groups. src/commands/ : BAM extraction, split-reads clustering, VCF export, BAM imputation, contig/read utilities, longitudinal agreement, and shared helpers. src/typing/ : typing entrypoint/CLI plus data handling, EM, model selection, imputation, methylation feature logic, Floria parsing, FASTQ splitting, and priors. See the usage pages for command-by-command details and examples.","title":"Overview"},{"location":"overview/#overview","text":"methylphase is a toolkit for BAM-driven methylation phasing and typing. It extracts per-read methylation features from mod-tagged alignments (MM/ML tags), clusters reads by motif patterns, and aggregates or imputes results for downstream analyses.","title":"Overview"},{"location":"overview/#what-methylphase-does","text":"Phase variants pipeline : end-to-end typing that merges motif-derived methylation features with a Floria haploset, selects a latent class model, and emits imputed labels and summaries. Split reads : cluster reads by motif methylation profiles (GMM by default; HDBSCAN and agglomerative are available) and write clustering tables plus optional FASTQ/BAM splits. Extract : intersect motifs with alignments to produce per-read and aggregate methylation tables, and optionally motif summaries or FASTQ subsets. Typing utilities : EM fitting, model selection, imputation, Floria conversion, and FASTQ splitting from existing assignments. Utilities : contig/read inspection, VCF summarization, methylation imputation directly into BAM, and longitudinal agreement checks.","title":"What methylphase does"},{"location":"overview/#inputs-and-assumptions","text":"Aligned BAM with MM/ML tags is required for methylation coordinates; provide a BAM index. If SEQ is missing, supply --sequence-fallback (FASTQ/BAM). Motifs can be inline ( GATC_6mA_1 ) or provided via file (TSV/CSV with motif, mod_type, mod_position, optional complement/bin/reference columns). Floria haploset (for phase-variants ) supplies SNP haplotypes that are merged with methylation features. Motif interpretation is strand-aware; complements in motif files control reverse-strand handling.","title":"Inputs and assumptions"},{"location":"overview/#outputs-high-level","text":"Split reads : read_clustering.tsv , read_clustering_raw.tsv , cluster_summary.tsv , and optional clustered FASTQ/BAMs. Phase variants : internal split_reads/ artifacts, dataset.tsv , categories.toml , fits/ , best_model.json , best_responsibilities.tsv , imputed.tsv , imputed_labels.tsv , and summary.json . Extract : per_read.tsv , aggregate.tsv , optional motif_summary.tsv , and FASTQ subsets when requested. Utilities : VCFs ( *.vcf or bgzip+tabix), imputed BAMs, and longitudinal reports.","title":"Outputs (high level)"},{"location":"overview/#modeling-notes","text":"Latent class model uses EM with Dirichlet priors for weights/emissions; supports continuous methylation features (Gaussian) and categorical haplotypes. Model selection defaults to ICL with penalty multiplier 2.0 and class bounds 1..10; alternative criteria include BIC and cross-validation. Imputation outputs MAP labels for categorical fields and responsibility-weighted means for methylation features; classes with low weight can be pruned.","title":"Modeling notes"},{"location":"overview/#project-layout-code","text":"src/main.rs : CLI entrypoint, delegates to commands::run . src/cli.rs : top-level CLI definitions for commands/groups. src/commands/ : BAM extraction, split-reads clustering, VCF export, BAM imputation, contig/read utilities, longitudinal agreement, and shared helpers. src/typing/ : typing entrypoint/CLI plus data handling, EM, model selection, imputation, methylation feature logic, Floria parsing, FASTQ splitting, and priors. See the usage pages for command-by-command details and examples.","title":"Project layout (code)"},{"location":"examples/analysis/","text":"Example analysis \u00b6 This walkthrough demonstrates a typical methylphase run on a mod-tagged BAM with motif-driven typing. Inputs \u00b6 sample.mod.bam + index Motifs file motifs.tsv (columns: motif , mod_type , mod_position , optional complement , bin , reference ) Floria haploset haplotypes.hapset Steps \u00b6 1) Inspect contigs (optional sanity check) bash methylphase utils contigs --bam sample.mod.bam 2) Extract per-read methylation (optional debugging artifact) bash methylphase extract \\ --bam sample.mod.bam \\ --motif-file motifs.tsv \\ --output-dir results/extract \\ --motif-summary 3) Run the full phase-variants pipeline bash methylphase phase-variants \\ --floria haplotypes.hapset \\ --bam sample.mod.bam \\ --motif-file motifs.tsv \\ --out results/phase_variants \\ --min-classes 1 \\ --max-classes 8 4) Review clustering and model choice - results/phase_variants/split_reads/read_clustering_raw.tsv for per-read motif features and clusters. - results/phase_variants/fits/ for per-class log-likelihoods and criteria. - results/phase_variants/summary.json for the selected model and criteria values. 5) Use the imputed outputs - imputed.tsv for completed datasets (continuous and categorical fields). - imputed_labels.tsv for MAP class labels. - Feed these into downstream association tests or visualization tools. Optional follow-ups \u00b6 Convert aggregated methylation to VCF for external tools: bash methylphase utils vcf \\ --bam sample.mod.bam \\ --motif-file motifs.tsv \\ --output results/phase_variants/calls.vcf.bgz \\ --plain-output \\ --sample-name sample1 tabix -p vcf results/phase_variants/calls.vcf.bgz Split FASTQs by inferred class for downstream assembly/analysis: bash methylphase typing split-fastq \\ --fastq reads.fastq.gz \\ --responsibilities results/phase_variants/best_responsibilities.tsv \\ --output-dir results/phase_variants/fastq_by_class","title":"Example analysis"},{"location":"examples/analysis/#example-analysis","text":"This walkthrough demonstrates a typical methylphase run on a mod-tagged BAM with motif-driven typing.","title":"Example analysis"},{"location":"examples/analysis/#inputs","text":"sample.mod.bam + index Motifs file motifs.tsv (columns: motif , mod_type , mod_position , optional complement , bin , reference ) Floria haploset haplotypes.hapset","title":"Inputs"},{"location":"examples/analysis/#steps","text":"1) Inspect contigs (optional sanity check) bash methylphase utils contigs --bam sample.mod.bam 2) Extract per-read methylation (optional debugging artifact) bash methylphase extract \\ --bam sample.mod.bam \\ --motif-file motifs.tsv \\ --output-dir results/extract \\ --motif-summary 3) Run the full phase-variants pipeline bash methylphase phase-variants \\ --floria haplotypes.hapset \\ --bam sample.mod.bam \\ --motif-file motifs.tsv \\ --out results/phase_variants \\ --min-classes 1 \\ --max-classes 8 4) Review clustering and model choice - results/phase_variants/split_reads/read_clustering_raw.tsv for per-read motif features and clusters. - results/phase_variants/fits/ for per-class log-likelihoods and criteria. - results/phase_variants/summary.json for the selected model and criteria values. 5) Use the imputed outputs - imputed.tsv for completed datasets (continuous and categorical fields). - imputed_labels.tsv for MAP class labels. - Feed these into downstream association tests or visualization tools.","title":"Steps"},{"location":"examples/analysis/#optional-follow-ups","text":"Convert aggregated methylation to VCF for external tools: bash methylphase utils vcf \\ --bam sample.mod.bam \\ --motif-file motifs.tsv \\ --output results/phase_variants/calls.vcf.bgz \\ --plain-output \\ --sample-name sample1 tabix -p vcf results/phase_variants/calls.vcf.bgz Split FASTQs by inferred class for downstream assembly/analysis: bash methylphase typing split-fastq \\ --fastq reads.fastq.gz \\ --responsibilities results/phase_variants/best_responsibilities.tsv \\ --output-dir results/phase_variants/fastq_by_class","title":"Optional follow-ups"},{"location":"getting-started/installation/","text":"Installation \u00b6 Requirements \u00b6 Rust (stable, 2021 edition) and a C toolchain for compiling Rust crates. Indexed BAM inputs with MM/ML tags and available disk space for outputs. Optional: bgzip and tabix if you plan to bgzip/tabix VCFs produced by utils vcf . Install from source \u00b6 git clone <this-repo> cd methylphase cargo build --release # produces target/release/methylphase # or install into ~/.cargo/bin: cargo install --path . --force methylphase --help # verify the binary runs If you prefer a one-liner without cloning, you can install directly from the repository URL once it is public: cargo install --git https://github.com/<org>/methylphase --locked Updating \u00b6 Re-run cargo install --path . --force (or the --git form) after pulling changes. Environment tips \u00b6 Ensure BAM files are indexed ( samtools index sample.bam ) before running commands. Provide --sequence-fallback when SEQ is absent in BAM headers (FASTQ/BAM supported). Motifs can be inline ( GATC_6mA_1 ) or supplied via TSV/CSV; see extract for details.","title":"Installation"},{"location":"getting-started/installation/#installation","text":"","title":"Installation"},{"location":"getting-started/installation/#requirements","text":"Rust (stable, 2021 edition) and a C toolchain for compiling Rust crates. Indexed BAM inputs with MM/ML tags and available disk space for outputs. Optional: bgzip and tabix if you plan to bgzip/tabix VCFs produced by utils vcf .","title":"Requirements"},{"location":"getting-started/installation/#install-from-source","text":"git clone <this-repo> cd methylphase cargo build --release # produces target/release/methylphase # or install into ~/.cargo/bin: cargo install --path . --force methylphase --help # verify the binary runs If you prefer a one-liner without cloning, you can install directly from the repository URL once it is public: cargo install --git https://github.com/<org>/methylphase --locked","title":"Install from source"},{"location":"getting-started/installation/#updating","text":"Re-run cargo install --path . --force (or the --git form) after pulling changes.","title":"Updating"},{"location":"getting-started/installation/#environment-tips","text":"Ensure BAM files are indexed ( samtools index sample.bam ) before running commands. Provide --sequence-fallback when SEQ is absent in BAM headers (FASTQ/BAM supported). Motifs can be inline ( GATC_6mA_1 ) or supplied via TSV/CSV; see extract for details.","title":"Environment tips"},{"location":"getting-started/quickstart/","text":"Quickstart \u00b6 Use this minimal workflow to go from an indexed, mod-tagged BAM to phased methylation labels. 1) Collect inputs \u00b6 Indexed BAM with MM/ML tags: sample.mod.bam and sample.mod.bam.bai . Motifs to interrogate (inline list or motif file). Floria haploset (for the full typing pipeline). 2) Run the end-to-end pipeline \u00b6 This drives split-reads internally, merges haplotype and methylation features, selects the best latent class model, and imputes labels. methylphase phase-variants \\ --floria haplotypes.hapset \\ --bam sample.mod.bam \\ --motif CG_5,GATC_6mA_1 \\ --out results/phase_variants \\ --min-classes 1 \\ --max-classes 8 Key outputs land under results/phase_variants : split_reads/* , dataset.tsv , categories.toml , best_model.json , best_responsibilities.tsv , imputed.tsv , and imputed_labels.tsv . 3) Inspect quick summaries \u00b6 Cluster assignments and raw features: split_reads/read_clustering_raw.tsv Imputed labels and summary JSON: imputed_labels.tsv , summary.json Model diagnostics per class count: fits/ Alternative quick run: split and aggregate only \u00b6 If you just need read clustering and per-read methylation tables: methylphase extract \\ --bam sample.mod.bam \\ --motif CG_5 \\ --output-dir results/extract methylphase split-reads \\ --bam sample.mod.bam \\ --motif-file motifs.tsv \\ --output-dir results/split \\ --cluster-algorithm hdbscan \\ --emit-fastq \\ --threads 8 Next, dive into the command-specific pages under usage/ for detailed arguments and outputs.","title":"Quickstart"},{"location":"getting-started/quickstart/#quickstart","text":"Use this minimal workflow to go from an indexed, mod-tagged BAM to phased methylation labels.","title":"Quickstart"},{"location":"getting-started/quickstart/#1-collect-inputs","text":"Indexed BAM with MM/ML tags: sample.mod.bam and sample.mod.bam.bai . Motifs to interrogate (inline list or motif file). Floria haploset (for the full typing pipeline).","title":"1) Collect inputs"},{"location":"getting-started/quickstart/#2-run-the-end-to-end-pipeline","text":"This drives split-reads internally, merges haplotype and methylation features, selects the best latent class model, and imputes labels. methylphase phase-variants \\ --floria haplotypes.hapset \\ --bam sample.mod.bam \\ --motif CG_5,GATC_6mA_1 \\ --out results/phase_variants \\ --min-classes 1 \\ --max-classes 8 Key outputs land under results/phase_variants : split_reads/* , dataset.tsv , categories.toml , best_model.json , best_responsibilities.tsv , imputed.tsv , and imputed_labels.tsv .","title":"2) Run the end-to-end pipeline"},{"location":"getting-started/quickstart/#3-inspect-quick-summaries","text":"Cluster assignments and raw features: split_reads/read_clustering_raw.tsv Imputed labels and summary JSON: imputed_labels.tsv , summary.json Model diagnostics per class count: fits/","title":"3) Inspect quick summaries"},{"location":"getting-started/quickstart/#alternative-quick-run-split-and-aggregate-only","text":"If you just need read clustering and per-read methylation tables: methylphase extract \\ --bam sample.mod.bam \\ --motif CG_5 \\ --output-dir results/extract methylphase split-reads \\ --bam sample.mod.bam \\ --motif-file motifs.tsv \\ --output-dir results/split \\ --cluster-algorithm hdbscan \\ --emit-fastq \\ --threads 8 Next, dive into the command-specific pages under usage/ for detailed arguments and outputs.","title":"Alternative quick run: split and aggregate only"},{"location":"usage/extract/","text":"Extract methylation calls \u00b6 methylphase extract intersects motifs with mod-tagged alignments and emits per-read and aggregate methylation calls. Common arguments \u00b6 --bam <mod.bam> : indexed BAM with MM/ML tags. Motifs: --motif CG_5,GATC_6mA_1 or --motif-file motifs.tsv (TSV/CSV with motif , mod_type , mod_position , optional complement , bin , reference columns). --output-dir <dir> : destination for TSVs (created if missing). --sequence-fallback <fastq|bam> : when SEQ is absent in BAM. Optional: --motif-summary to emit per-motif summaries; FASTQ subsets can be written when requested. Outputs \u00b6 per_read.tsv : methylation calls per read and motif occurrence. aggregate.tsv : aggregated motif-level calls. Optional motif_summary.tsv and FASTQ subsets if requested. Example \u00b6 methylphase extract \\ --bam sample.mod.bam \\ --motif-file motifs.tsv \\ --output-dir results/extract \\ --motif-summary","title":"Extract methylation calls"},{"location":"usage/extract/#extract-methylation-calls","text":"methylphase extract intersects motifs with mod-tagged alignments and emits per-read and aggregate methylation calls.","title":"Extract methylation calls"},{"location":"usage/extract/#common-arguments","text":"--bam <mod.bam> : indexed BAM with MM/ML tags. Motifs: --motif CG_5,GATC_6mA_1 or --motif-file motifs.tsv (TSV/CSV with motif , mod_type , mod_position , optional complement , bin , reference columns). --output-dir <dir> : destination for TSVs (created if missing). --sequence-fallback <fastq|bam> : when SEQ is absent in BAM. Optional: --motif-summary to emit per-motif summaries; FASTQ subsets can be written when requested.","title":"Common arguments"},{"location":"usage/extract/#outputs","text":"per_read.tsv : methylation calls per read and motif occurrence. aggregate.tsv : aggregated motif-level calls. Optional motif_summary.tsv and FASTQ subsets if requested.","title":"Outputs"},{"location":"usage/extract/#example","text":"methylphase extract \\ --bam sample.mod.bam \\ --motif-file motifs.tsv \\ --output-dir results/extract \\ --motif-summary","title":"Example"},{"location":"usage/phase-variants/","text":"Phase variants pipeline \u00b6 methylphase phase-variants is the end-to-end typing workflow. It extracts methylation features (via split-reads), merges them with a Floria haploset, selects the best latent class model, imputes labels, and emits summaries. Inputs \u00b6 --floria <haploset> : Floria haplotype set to merge with methylation features. --bam <mod.bam> : Indexed BAM with MM/ML tags. Motifs: --motif CG_5,GATC_6mA_1 or --motif-file motifs.tsv . Optional --sequence-fallback <fastq|bam> when SEQ is missing from the BAM. Optional binning ( --binning-file ) to stratify outputs by contig bin. Core options \u00b6 --min-classes , --max-classes : bounds for class search (default 1..10). --criterion : model selection ( icl default, bic , or cv ). --penalty-multiplier : scales the selection penalty (default 2.0 for ICL). --out : output directory (created if missing). Split-reads internals: uses GMM clustering by default to generate read_clustering_raw.tsv . Typical command \u00b6 methylphase phase-variants \\ --floria haplotypes.hapset \\ --bam sample.mod.bam \\ --motif CG_5,GATC_6mA_1 \\ --out results/phase_variants \\ --min-classes 1 \\ --max-classes 8 Outputs \u00b6 split_reads/ : internal clustering artifacts, including read_clustering_raw.tsv . dataset.tsv , categories.toml : merged data/config used for typing. fits/ : model fits per class count. best_model.json , best_responsibilities.tsv : selected model and responsibilities. imputed.tsv , imputed_labels.tsv : completed data and labels. summary.json : run metadata and selection summary.","title":"Phase variants pipeline"},{"location":"usage/phase-variants/#phase-variants-pipeline","text":"methylphase phase-variants is the end-to-end typing workflow. It extracts methylation features (via split-reads), merges them with a Floria haploset, selects the best latent class model, imputes labels, and emits summaries.","title":"Phase variants pipeline"},{"location":"usage/phase-variants/#inputs","text":"--floria <haploset> : Floria haplotype set to merge with methylation features. --bam <mod.bam> : Indexed BAM with MM/ML tags. Motifs: --motif CG_5,GATC_6mA_1 or --motif-file motifs.tsv . Optional --sequence-fallback <fastq|bam> when SEQ is missing from the BAM. Optional binning ( --binning-file ) to stratify outputs by contig bin.","title":"Inputs"},{"location":"usage/phase-variants/#core-options","text":"--min-classes , --max-classes : bounds for class search (default 1..10). --criterion : model selection ( icl default, bic , or cv ). --penalty-multiplier : scales the selection penalty (default 2.0 for ICL). --out : output directory (created if missing). Split-reads internals: uses GMM clustering by default to generate read_clustering_raw.tsv .","title":"Core options"},{"location":"usage/phase-variants/#typical-command","text":"methylphase phase-variants \\ --floria haplotypes.hapset \\ --bam sample.mod.bam \\ --motif CG_5,GATC_6mA_1 \\ --out results/phase_variants \\ --min-classes 1 \\ --max-classes 8","title":"Typical command"},{"location":"usage/phase-variants/#outputs","text":"split_reads/ : internal clustering artifacts, including read_clustering_raw.tsv . dataset.tsv , categories.toml : merged data/config used for typing. fits/ : model fits per class count. best_model.json , best_responsibilities.tsv : selected model and responsibilities. imputed.tsv , imputed_labels.tsv : completed data and labels. summary.json : run metadata and selection summary.","title":"Outputs"},{"location":"usage/split-reads/","text":"Split reads \u00b6 methylphase split-reads clusters reads by motif methylation features and can write clustering tables plus per-cluster FASTQ/BAM files. Common arguments \u00b6 --bam <mod.bam> : indexed BAM with MM/ML tags. Motifs: --motif ... or --motif-file ... (same format as extract ). --output-dir <dir> : destination for clustering outputs. --cluster-algorithm <gmm|hdbscan|agglomerative> : clustering backend (default gmm ). --threads <n> : parallelism for feature extraction and clustering. Optional --emit-fastq (and related flags) to write per-cluster FASTQ/BAMs. Outputs \u00b6 read_clustering_raw.tsv : per-read cluster assignments with raw motif features. read_clustering.tsv : cleaned/filtered clustering table. cluster_summary.tsv : per-cluster counts and feature summaries. Optional clusters/*.fastq or *.bam when emitting sequences. Example \u00b6 methylphase split-reads \\ --bam sample.mod.bam \\ --motif CG_5,GATC_6mA_1 \\ --output-dir results/split \\ --cluster-algorithm hdbscan \\ --emit-fastq \\ --threads 8","title":"Split reads"},{"location":"usage/split-reads/#split-reads","text":"methylphase split-reads clusters reads by motif methylation features and can write clustering tables plus per-cluster FASTQ/BAM files.","title":"Split reads"},{"location":"usage/split-reads/#common-arguments","text":"--bam <mod.bam> : indexed BAM with MM/ML tags. Motifs: --motif ... or --motif-file ... (same format as extract ). --output-dir <dir> : destination for clustering outputs. --cluster-algorithm <gmm|hdbscan|agglomerative> : clustering backend (default gmm ). --threads <n> : parallelism for feature extraction and clustering. Optional --emit-fastq (and related flags) to write per-cluster FASTQ/BAMs.","title":"Common arguments"},{"location":"usage/split-reads/#outputs","text":"read_clustering_raw.tsv : per-read cluster assignments with raw motif features. read_clustering.tsv : cleaned/filtered clustering table. cluster_summary.tsv : per-cluster counts and feature summaries. Optional clusters/*.fastq or *.bam when emitting sequences.","title":"Outputs"},{"location":"usage/split-reads/#example","text":"methylphase split-reads \\ --bam sample.mod.bam \\ --motif CG_5,GATC_6mA_1 \\ --output-dir results/split \\ --cluster-algorithm hdbscan \\ --emit-fastq \\ --threads 8","title":"Example"},{"location":"usage/typing/","text":"Typing utilities \u00b6 methylphase typing <subcommand> operates on tabular datasets and configs produced by phase-variants or your own pipelines. Core subcommands: fit \u00b6 Fit a latent class model with a fixed number of classes. methylphase typing fit \\ --data dataset.tsv \\ --config categories.toml \\ --classes 4 \\ --alpha-pi 1.0 \\ --alpha-phi 1.0 \\ --output-model fits/model_c4.json Outputs a model JSON and (optionally) responsibilities. select-best-c \u00b6 Score multiple class counts and pick the best according to a criterion. methylphase typing select-best-c \\ --data dataset.tsv \\ --config categories.toml \\ --classes 1..10 \\ --criterion icl \\ --penalty-multiplier 2.0 \\ --output-dir fits Emits per-class fits in fits/ , best_model.json , and best_responsibilities.tsv . impute \u00b6 Impute missing categorical/methylation values given a fitted model. methylphase typing impute \\ --data dataset.tsv \\ --config categories.toml \\ --model best_model.json \\ --responsibilities best_responsibilities.tsv \\ --output imputed.tsv \\ --output-labels imputed_labels.tsv convert-floria \u00b6 Convert a Floria haploset to the dataset/config format used by typing. methylphase typing convert-floria \\ --haploset haplotypes.hapset \\ --output-data dataset.tsv \\ --output-config categories.toml Optionally merge methylation features if provided. split-fastq \u00b6 Split FASTQ files using assignments/responsibilities. methylphase typing split-fastq \\ --fastq reads.fastq.gz \\ --responsibilities best_responsibilities.tsv \\ --output-dir fastq_by_class","title":"Typing utilities"},{"location":"usage/typing/#typing-utilities","text":"methylphase typing <subcommand> operates on tabular datasets and configs produced by phase-variants or your own pipelines. Core subcommands:","title":"Typing utilities"},{"location":"usage/typing/#fit","text":"Fit a latent class model with a fixed number of classes. methylphase typing fit \\ --data dataset.tsv \\ --config categories.toml \\ --classes 4 \\ --alpha-pi 1.0 \\ --alpha-phi 1.0 \\ --output-model fits/model_c4.json Outputs a model JSON and (optionally) responsibilities.","title":"fit"},{"location":"usage/typing/#select-best-c","text":"Score multiple class counts and pick the best according to a criterion. methylphase typing select-best-c \\ --data dataset.tsv \\ --config categories.toml \\ --classes 1..10 \\ --criterion icl \\ --penalty-multiplier 2.0 \\ --output-dir fits Emits per-class fits in fits/ , best_model.json , and best_responsibilities.tsv .","title":"select-best-c"},{"location":"usage/typing/#impute","text":"Impute missing categorical/methylation values given a fitted model. methylphase typing impute \\ --data dataset.tsv \\ --config categories.toml \\ --model best_model.json \\ --responsibilities best_responsibilities.tsv \\ --output imputed.tsv \\ --output-labels imputed_labels.tsv","title":"impute"},{"location":"usage/typing/#convert-floria","text":"Convert a Floria haploset to the dataset/config format used by typing. methylphase typing convert-floria \\ --haploset haplotypes.hapset \\ --output-data dataset.tsv \\ --output-config categories.toml Optionally merge methylation features if provided.","title":"convert-floria"},{"location":"usage/typing/#split-fastq","text":"Split FASTQ files using assignments/responsibilities. methylphase typing split-fastq \\ --fastq reads.fastq.gz \\ --responsibilities best_responsibilities.tsv \\ --output-dir fastq_by_class","title":"split-fastq"},{"location":"usage/utils/","text":"Utility commands \u00b6 methylphase utils <subcommand> provides supporting tools for inspection and downstream use. vcf \u00b6 Summarize motif methylation to VCF (optionally bgzip+tabix). methylphase utils vcf \\ --bam sample.mod.bam \\ --motif CG_5 \\ --output calls.vcf.bgz \\ --plain-output \\ --sample-name sample1 impute-bam \u00b6 Impute bases/qualities directly into a BAM using methylation probabilities. methylphase utils impute-bam \\ --bam sample.mod.bam \\ --motif CG_5 \\ --output imputed.bam \\ --prob-threshold 0.5 contigs \u00b6 List contigs in a BAM (with optional lengths). methylphase utils contigs --bam sample.mod.bam reads \u00b6 List read IDs for selected contigs (optionally capped). methylphase utils reads --bam sample.mod.bam --contig chr1 --limit 1000 longitudinal \u00b6 Compute longitudinal methylation agreement across contigs/bins. methylphase utils longitudinal \\ --bam sample.mod.bam \\ --motif-file motifs.tsv \\ --output longitudinal.tsv","title":"Utility commands"},{"location":"usage/utils/#utility-commands","text":"methylphase utils <subcommand> provides supporting tools for inspection and downstream use.","title":"Utility commands"},{"location":"usage/utils/#vcf","text":"Summarize motif methylation to VCF (optionally bgzip+tabix). methylphase utils vcf \\ --bam sample.mod.bam \\ --motif CG_5 \\ --output calls.vcf.bgz \\ --plain-output \\ --sample-name sample1","title":"vcf"},{"location":"usage/utils/#impute-bam","text":"Impute bases/qualities directly into a BAM using methylation probabilities. methylphase utils impute-bam \\ --bam sample.mod.bam \\ --motif CG_5 \\ --output imputed.bam \\ --prob-threshold 0.5","title":"impute-bam"},{"location":"usage/utils/#contigs","text":"List contigs in a BAM (with optional lengths). methylphase utils contigs --bam sample.mod.bam","title":"contigs"},{"location":"usage/utils/#reads","text":"List read IDs for selected contigs (optionally capped). methylphase utils reads --bam sample.mod.bam --contig chr1 --limit 1000","title":"reads"},{"location":"usage/utils/#longitudinal","text":"Compute longitudinal methylation agreement across contigs/bins. methylphase utils longitudinal \\ --bam sample.mod.bam \\ --motif-file motifs.tsv \\ --output longitudinal.tsv","title":"longitudinal"}]}